"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const webpack = require("webpack");
const utils_1 = require("./utils");
const base_1 = require("./base");
const path_1 = require("@vuesion/utils/dist/path");
const models_1 = require("@vuesion/models");
exports.baseServer = utils_1.merge(base_1.base, {
    target: 'node',
    output: {
        path: path_1.runtimeRoot('dist/server'),
        libraryTarget: 'commonjs',
    },
    externals: [
        utils_1.nodeExternals({
            whitelist: ['webpack/hot/poll?1000'],
        }),
    ],
    plugins: [
        new webpack.DefinePlugin({
            CLIENT: false,
            SERVER: true,
            nodeRequire: 'function(module){return require(module);}',
        }),
    ],
    node: {
        __dirname: false,
        __filename: false,
    },
});
exports.default = models_1.VuesionConfig.getCustomWebpackConfig(exports.baseServer, 'server');
